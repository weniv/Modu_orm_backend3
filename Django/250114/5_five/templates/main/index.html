{% extends 'base/base.html' %}

{% block contents %}
<div class="post-form">
    <textarea 
        class="post-input" 
        placeholder="ë¬´ìŠ¨ ìƒê°ì„ í•˜ê³  ê³„ì‹ ê°€ìš”?"
    ></textarea>
    <button class="post-button" disabled>ê²Œì‹œí•˜ê¸°</button>
    <div style="clear: both;"></div>
</div>

<div class="posts-container">
    <!-- ê²Œì‹œë¬¼ë“¤ì´ ì—¬ê¸°ì— ë™ì ìœ¼ë¡œ ì¶”ê°€ë©ë‹ˆë‹¤ -->
</div>
{% endblock %}

{% block script %}
<script>
    // DOM ìš”ì†Œë“¤
    const postInput = document.querySelector('.post-input');
    const postButton = document.querySelector('.post-button');
    const postsContainer = document.querySelector('.posts-container');

    // ê²Œì‹œë¬¼ ì…ë ¥ í™œì„±í™”/ë¹„í™œì„±í™” ì²˜ë¦¬
    postInput.addEventListener('input', () => {
        postButton.disabled = postInput.value.trim().length === 0;
    });

    // ê²Œì‹œë¬¼ ìƒì„± ì²˜ë¦¬
    postButton.addEventListener('click', () => {
        const content = postInput.value.trim();
        if (content) {
            createPost(content);
            postInput.value = '';
            postButton.disabled = true;
        }
    });

    // ê²Œì‹œë¬¼ HTML ìƒì„± í•¨ìˆ˜
    function createPost(content) {
        const post = document.createElement('div');
        post.className = 'post';
        
        const timestamp = new Date().toLocaleString('ko-KR');
        let likes = 0;
        
        post.innerHTML = `
            <div class="post-header">
                <div class="profile-image"></div>
                <div>
                    <div class="username">ì‚¬ìš©ì</div>
                    <small>${timestamp}</small>
                </div>
            </div>
            <div class="post-content">${content}</div>
            <div class="post-actions">
                <button class="action-button like-button">
                    â™¡ <span class="likes-count">${likes}</span>
                </button>
                <button class="action-button">
                    ğŸ’¬ ëŒ“ê¸€
                </button>
            </div>
            <div class="comments-section">
                <input type="text" class="comment-input" placeholder="ëŒ“ê¸€ì„ ì…ë ¥í•˜ì„¸ìš”...">
            </div>
        `;

        // ì¢‹ì•„ìš” ê¸°ëŠ¥
        const likeButton = post.querySelector('.like-button');
        likeButton.addEventListener('click', () => {
            likes++;
            post.querySelector('.likes-count').textContent = likes;
            likeButton.innerHTML = `â™¥ <span class="likes-count">${likes}</span>`;
        });

        // ëŒ“ê¸€ ì…ë ¥ ì²˜ë¦¬
        const commentInput = post.querySelector('.comment-input');
        commentInput.addEventListener('keypress', (e) => {
            if (e.key === 'Enter' && commentInput.value.trim()) {
                const comment = document.createElement('div');
                comment.className = 'comment';
                comment.innerHTML = `
                    <div class="profile-image"></div>
                    <div>
                        <div class="username">ì‚¬ìš©ì</div>
                        <div>${commentInput.value}</div>
                    </div>
                `;
                post.querySelector('.comments-section').appendChild(comment);
                commentInput.value = '';
            }
        });

        // ìµœì‹  ê²Œì‹œë¬¼ì´ ìœ„ì— ì˜¤ë„ë¡ ì¶”ê°€
        postsContainer.insertBefore(post, postsContainer.firstChild);
    }

    // ì´ˆê¸° ë”ë¯¸ ë°ì´í„° ìƒì„±
    createPost("ì•ˆë…•í•˜ì„¸ìš”! Threadsì— ì˜¤ì‹  ê²ƒì„ í™˜ì˜í•©ë‹ˆë‹¤. ğŸ‰");
</script>
{% endblock %}